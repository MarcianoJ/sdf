module refactorings

imports
	include/MiniJava-completions
	editor-common.generated
	new-completions/-
	//src-gen/refactorings/-

rules
	
	      
      
   expand-placeholder-refactoring:
   	(user-input, selected, position, ast, path, project-path) -> (changes, fatal-errors, errors, warnings)
	with
	  debug(!"input for refactoring : ");
	  suggestions  := <new-iset>;
	  new-node     := <try(suggest-completions(|suggestions))> selected;
	  <iset-elements; debug(!"suggestions ")> suggestions;
	  new-ast*     := <iset-elements; map(\ x -> <at-position(expand-node(|x)|position)> ast \)> suggestions;
	  changes      := <map(!(ast, <id>))> new-ast*;		
	  fatal-errors := [];
      errors       := [];
      warnings     := []         
   	   

   expand-node(|new-node):
   	node -> new-node
   	
   add-completions(|suggestion) = iset-add(|suggestion)
   		
   		
   //inline-completions = fail
   
   		
   inline-completions(|sort):
	term -> elem
	where
		<not(?sort)> term;
		iset  := <new-iset>;
		<try(suggest-completions(|iset))> term;
		elems := <iset-elements> iset; 
		<?[elem]> elems		

   		